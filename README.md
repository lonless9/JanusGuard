# ğŸ›¡ï¸ JanusGuard

<div align="center">
  <img src="https://img.shields.io/badge/Java-8%2B-orange" alt="Java 8+">
  <img src="https://img.shields.io/badge/License-MIT-blue" alt="License">
  <img src="https://img.shields.io/badge/Status-Alpha-yellow" alt="Status">
  <br>
  <strong>Javaåº”ç”¨è¿è¡Œæ—¶å®‰å…¨ç›‘æ§ç³»ç»Ÿ</strong>
  <p>åŸºäºJava Agentå’Œå­—èŠ‚ç è½¬æ¢æŠ€æœ¯çš„åº”ç”¨å®‰å…¨å®ˆæŠ¤æ–¹æ¡ˆ</p>
</div>

## ğŸ“‹ æ¦‚è¿°

JanusGuardæ˜¯ä¸€ä¸ªJavaåº”ç”¨è¿è¡Œæ—¶å®‰å…¨ç›‘æ§ç³»ç»Ÿï¼Œé€šè¿‡Java AgentæŠ€æœ¯å’Œå­—èŠ‚ç è½¬æ¢å®ç°å¯¹åº”ç”¨è¡Œä¸ºçš„ç›‘æ§å’Œå®‰å…¨é£é™©æ£€æµ‹ï¼Œæ—¨åœ¨æä¾›ä¸€ç§ä½ä¾µå…¥ã€å¯é…ç½®çš„å®‰å…¨é˜²æŠ¤æ–¹æ¡ˆã€‚

## ğŸ” æ ¸å¿ƒç†å¿µ

- **ğŸ“Š ä½ä¾µå…¥ç›‘æ§:** æœ€å°åŒ–æ€§èƒ½å¼€é”€ï¼Œå¯¹åº”ç”¨é€æ˜
- **ğŸ§  æ™ºèƒ½åˆ†æ:** ç»“åˆä¸Šä¸‹æ–‡å’Œè¡Œä¸ºåˆ†æè¿›è¡Œå®‰å…¨åˆ¤æ–­
- **âš™ï¸ åŠ¨æ€è°ƒæ•´:** æ”¯æŒè¿è¡Œæ—¶è°ƒæ•´ç›‘æ§èŒƒå›´å’Œç­–ç•¥
- **ğŸ”— äº‹ä»¶å…³è”:** åˆ†æå¤šä¸ªäº‹ä»¶é—´å…³ç³»ä»¥å‘ç°å¤æ‚æ”»å‡»æ¨¡å¼ 
- **ğŸ§© æ‰©å±•æ€§è®¾è®¡:** æ”¯æŒè‡ªå®šä¹‰ç›‘æ§ç‚¹å’Œåˆ†ææ–¹æ³•

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

- **ğŸ”„ æ— ä»£ç ä¿®æ”¹:** æ— éœ€æ›´æ”¹åº”ç”¨æºç ï¼Œç›´æ¥é€šè¿‡JVMå‚æ•°åŠ è½½
- **âš¡ é«˜æ•ˆæ‰§è¡Œ:** é‡‡ç”¨è½»é‡çº§æ¢é’ˆè®¾è®¡å’Œé«˜æ€§èƒ½é˜Ÿåˆ—å¤„ç†
- **ğŸ”§ çµæ´»é…ç½®:** æ”¯æŒå¤šç§é…ç½®æ–¹å¼å’Œç­–ç•¥è°ƒæ•´
- **ğŸš€ ç®€ä¾¿éƒ¨ç½²:** æ”¯æŒå¯åŠ¨æ—¶åŠ è½½æˆ–è¿è¡Œæ—¶åŠ¨æ€é™„åŠ 
- **ğŸ” å…¨é¢ç›‘æ§:** è¦†ç›–å¸¸è§å®‰å…¨æ•æ„Ÿæ“ä½œç‚¹

## âœ… å·²å®ç°åŠŸèƒ½

ç›®å‰ç‰ˆæœ¬å·²å®Œæˆçš„åŠŸèƒ½ï¼š

- **ğŸ—ï¸ æ ¸å¿ƒæ¡†æ¶:** 
  - Agentç”Ÿå‘½å‘¨æœŸç®¡ç†
  - é…ç½®åŠ è½½ä¸éªŒè¯
  - ç»„ä»¶åˆå§‹åŒ–ä¸ç»ˆæ­¢

- **ğŸ‘ï¸ ç›‘æ§ç‚¹:** 
  - å‘½ä»¤æ‰§è¡Œ (`Runtime.exec`, `ProcessBuilder.start`)
  - æ–‡ä»¶æ“ä½œ (`FileInputStream`, `FileOutputStream`, `RandomAccessFile`)
  - åå°„è°ƒç”¨ (`Method.invoke`)

- **ğŸ“Š äº‹ä»¶å¤„ç†:** 
  - äº‹ä»¶æ”¶é›†ä¸è¿‡æ»¤
  - å¼‚æ­¥é˜Ÿåˆ—å¤„ç†
  - æœ¬åœ°å­˜å‚¨è®°å½•

- **âš™ï¸ é…ç½®ç³»ç»Ÿ:** 
  - YAMLé…ç½®æ–‡ä»¶æ”¯æŒ
  - å‘½ä»¤è¡Œå‚æ•°è®¾ç½®

## ğŸ›ï¸ æ¶æ„è®¾è®¡

```mermaid
graph TD
    A[ç›®æ ‡Javaåº”ç”¨] -- JVMå¯åŠ¨/è¿è¡Œæ—¶åŠ è½½ --> B(JanusGuard Agent);
    B -- ä½¿ç”¨ java.lang.instrument --> C{JVM};
    C -- ClassFileTransformer --> D[å­—èŠ‚ç è½¬æ¢å¼•æ“];
    D -- é…ç½®é©±åŠ¨ --> E[ç›®æ ‡ç±»/æ–¹æ³•é€‰æ‹©];
    D -- Byte Buddy --> F[å­—èŠ‚ç å¢å¼º];
    F -- æ¤å…¥ --> G[ç›‘æ§æ¢é’ˆ];
    G -- äº‹ä»¶äº§ç”Ÿ --> H[äº‹ä»¶å¤„ç†æ¨¡å—];
    H -- è¿‡æ»¤/å¤„ç† --> I[é«˜æ€§èƒ½äº‹ä»¶é˜Ÿåˆ—];
    I -- å¼‚æ­¥ä¸ŠæŠ¥ --> J{æ•°æ®ä¸ŠæŠ¥æœåŠ¡};
    K[é…ç½®ç®¡ç†] -- åŠ è½½/æ›´æ–° --> B;
    K -- ç­–ç•¥ä¸‹å‘ --> H;
    J -- æ•°æ®æµ --> L[åˆ†æå¹³å°];
    J -- æ§åˆ¶æŒ‡ä»¤ --> K;
    L -- å‘Šè­¦ç”Ÿæˆ --> M[å®‰å…¨å›¢é˜Ÿ];
    L -- æ¨¡å‹è®­ç»ƒ --> N[è¡Œä¸ºåŸºçº¿];
    N -- æ›´æ–°è§„åˆ™ --> J;

    classDef main fill:#f9f,stroke:#333,stroke-width:1px
    classDef engine fill:#ccf,stroke:#333,stroke-width:1px
    classDef monitor fill:#ccf,stroke:#333,stroke-width:1px
    classDef proc fill:#fcc,stroke:#333,stroke-width:1px
    classDef report fill:#ff9,stroke:#333,stroke-width:1px
    classDef backend fill:#9cf,stroke:#333,stroke-width:1px
    
    class B main
    class D,F engine
    class G monitor
    class H proc
    class J report
    class L,N backend
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“¥ å®‰è£…

ä»[Releases](https://github.com/your-repo/janusguard/releases)ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„JanusGuard Agent JARæ–‡ä»¶ã€‚

### â–¶ï¸ åœ¨åº”ç”¨å¯åŠ¨æ—¶åŠ è½½Agent

```bash
java -javaagent:/path/to/janusguard-agent-1.0.0.jar -jar your-application.jar
```

### âš™ï¸ é…ç½®Agent

é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æˆ–é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ï¼š

```bash
java -javaagent:/path/to/janusguard-agent-1.0.0.jar=config=/path/to/config.yaml -jar your-application.jar
```

## ğŸ“ é…ç½®å‚è€ƒ

JanusGuardæ”¯æŒä»¥ä¸‹é…ç½®é€‰é¡¹ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `monitor.command` | å¯ç”¨å‘½ä»¤æ‰§è¡Œç›‘æ§ | `true` |
| `monitor.file` | å¯ç”¨æ–‡ä»¶æ“ä½œç›‘æ§ | `true` |
| `monitor.reflection` | å¯ç”¨åå°„è°ƒç”¨ç›‘æ§ | `true` |
| `sampling.rate` | äº‹ä»¶é‡‡æ ·ç‡ (0-100) | `100` |
| `report.mode` | ä¸ŠæŠ¥æ¨¡å¼ (file/http/grpc) | `file` |
| `log.level` | æ—¥å¿—çº§åˆ« | `INFO` |

è¯¦ç»†é…ç½®è¯´æ˜è¯·å‚è€ƒ[é…ç½®æ–‡æ¡£](docs/configuration.md)ã€‚

## ğŸ› ï¸ æ„å»ºé¡¹ç›®

é¡¹ç›®ä½¿ç”¨Gradleæ„å»ºï¼š

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/your-repo/janusguard.git
cd janusguard

# æ„å»ºé¡¹ç›®
./gradlew build

# æ„å»ºä¸æ‰§è¡Œæµ‹è¯•
./gradlew build -x test
```

æ„å»ºäº§ç‰©ä½äº`build/libs/`ç›®å½•ï¼š
- `janusguard-agent-1.0.0-SNAPSHOT.jar` - åŒ…å«æ‰€æœ‰ä¾èµ–çš„å®Œæ•´AgentåŒ…
- `jvm_agent-1.0.0-SNAPSHOT.jar` - ä¸åŒ…å«ä¾èµ–çš„åŸºç¡€åŒ…

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
jvm_agent/
â”œâ”€â”€ src/                             # æºä»£ç 
â”‚   â”œâ”€â”€ main/java/com/janusguard/
â”‚   â”‚   â”œâ”€â”€ agent/                   # Agentä¸»ä½“
â”‚   â”‚   â”œâ”€â”€ transformer/             # å­—èŠ‚ç è½¬æ¢
â”‚   â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ transport/               # æ•°æ®ä¼ è¾“
â”‚   â”‚   â”œâ”€â”€ config/                  # é…ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ common/                  # å…¬å…±å·¥å…·
â”‚   â””â”€â”€ test/                        # æµ‹è¯•ä»£ç 
â”œâ”€â”€ examples/                        # ç¤ºä¾‹åº”ç”¨
â”œâ”€â”€ docs/                            # æ–‡æ¡£
â””â”€â”€ build.gradle                     # æ„å»ºé…ç½®
```

## ğŸ“š æŠ€æœ¯æ ˆ

JanusGuardåŸºäºä»¥ä¸‹æ ¸å¿ƒæŠ€æœ¯ï¼š

- **ğŸ”„ [Byte Buddy](https://bytebuddy.net/)**: é«˜çº§å­—èŠ‚ç ç”Ÿæˆå’Œæ“ä½œåº“
- **ğŸ“ [SLF4J](http://www.slf4j.org/) + [Logback](http://logback.qos.ch/)**: æ—¥å¿—æ¡†æ¶
- **âš¡ [LMAX Disruptor](https://lmax-exchange.github.io/disruptor/)**: é«˜æ€§èƒ½çº¿ç¨‹é—´æ¶ˆæ¯ä¼ é€’åº“
- **ğŸ”„ [Jackson](https://github.com/FasterXML/jackson)**: JSONå¤„ç†
- **ğŸŒ [gRPC](https://grpc.io/)**: é«˜æ€§èƒ½RPCæ¡†æ¶(å¯é€‰)

## ğŸŒŸ ç‰¹è‰²åŠŸèƒ½

1. **ğŸ”„ è‡ªé€‚åº”ç›‘æ§:** æ”¯æŒæ ¹æ®åº”ç”¨è¡Œä¸ºç‰¹å¾è°ƒæ•´ç›‘æ§ç­–ç•¥
2. **ğŸ§  ä¸Šä¸‹æ–‡æ„ŸçŸ¥:** æ¢é’ˆå¯è¯†åˆ«æ‰€å¤„æ‰§è¡Œç¯å¢ƒï¼Œæä¾›å¤šç»´åº¦åˆ†ææ•°æ®
3. **ğŸ”— æœ¬åœ°äº‹ä»¶å…³è”:** åœ¨Agentç«¯å…³è”ç›¸å…³äº‹ä»¶ï¼Œæå‰å‘ç°å¯ç–‘è¡Œä¸º
4. **ğŸ§© è§„åˆ™è¡¨è¾¾å¼:** æ”¯æŒçµæ´»çš„è§„åˆ™å®šä¹‰å’ŒåŒ¹é…æ–¹å¼
5. **ğŸ”„ åŒå‘é€šä¿¡:** æ”¯æŒä¸æ§åˆ¶ä¸­å¿ƒåŒå‘é€šä¿¡ï¼Œæ¥æ”¶ç­–ç•¥æ›´æ–°
6. **ğŸ“Š æ€§èƒ½ä¼˜åŒ–:** é‡‡ç”¨å¤šç§æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ï¼Œé™ä½ç›‘æ§å¼€é”€

## ğŸ“… å¼€å‘è·¯çº¿

1. **ğŸ é˜¶æ®µä¸€: æ ¸å¿ƒæ¡†æ¶ä¸åŸºç¡€ç›‘æ§** âœ“
   * åŸºç¡€æ¡†æ¶ä¸æ¢é’ˆå®ç°
   * æ ¸å¿ƒç›‘æ§ç‚¹æ”¯æŒ
   * æœ¬åœ°æ—¥å¿—è®°å½•
   
2. **ğŸš§ é˜¶æ®µäºŒ: å¢å¼ºç›‘æ§ä¸æ€§èƒ½ä¼˜åŒ–** (è¿›è¡Œä¸­)
   * ç½‘ç»œæµé‡ç›‘æ§
   * åŠ¨æ€ç±»åŠ è½½ç›‘æ§
   * é«˜æ€§èƒ½äº‹ä»¶å¤„ç†
   * è§„åˆ™å¼•æ“è®¾è®¡
   
3. **ğŸ”® é˜¶æ®µä¸‰: æ™ºèƒ½åŒ–ä¸åŠ¨æ€ç­–ç•¥**
   * åŒå‘é€šä¿¡æœºåˆ¶
   * é…ç½®çƒ­æ›´æ–°
   * æœ¬åœ°äº‹ä»¶å…³è”åˆ†æ
   * é‡‡æ ·ç­–ç•¥å®ç°
   
4. **âœ¨ é˜¶æ®µå››: é«˜çº§ç‰¹æ€§ä¸ç”Ÿæ€æ•´åˆ**
   * æ•°æ®æµè·Ÿè¸ª
   * åˆ†æå¹³å°å¯¹æ¥
   * å…¼å®¹æ€§å¢å¼º
   * å®Œå–„æ–‡æ¡£ä¸å·¥å…·

è¯¦ç»†å¼€å‘è®¡åˆ’è¯·å‚è€ƒ[é¡¹ç›®è¿›åº¦](project_dev.md)ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºåŠŸèƒ½å»ºè®®ã€ä»£ç æäº¤ã€æ–‡æ¡£æ”¹è¿›ç­‰ã€‚

è¯¦æƒ…è¯·å‚é˜…[è´¡çŒ®æŒ‡å—](CONTRIBUTING.md)ã€‚

## ğŸ“„ è®¸å¯è¯

[MIT License](LICENSE)

---

<div align="center">
  <sub>Built with â¤ï¸ by the Shallow Ignore Team</sub>
</div> 